## 内存模型 

![img](https://img2018.cnblogs.com/blog/1240603/201905/1240603-20190502222538288-423837629.png)

JVM运行时数据区由程序计数器、堆、虚拟机栈、本地方法栈、方法区部分组成，结构图如上所示:

1）程序计数器

  几乎不占有内存。用于取下一条执行的指令。

 2）堆

所有通过new创建的对象的内存都在堆中分配，其大小可以通过**-Xmx**和**-Xms**来控制。

堆被划分为新生代和老年代，新生代又被进一步划分为Eden和Survivor区，最后Survivor由FromSpace和ToSpace组成，结构图如下所示：

**新生代**：新建的对象都是用新生代分配内存，Eden空间不足的时候，会把存活的对象转移到Survivor中，

新生代大小可以由-Xmn来控制，也可以用**-XX:SurvivorRatio**来控制Eden和Survivor的比例。

**老年代**：用于存放新生代中经过多次垃圾回收仍然存活的对象。

![img](https://images2018.cnblogs.com/blog/779030/201805/779030-20180510001611099-127788676.png)

3）栈

**每个线程执行每个方法**的时候都会在栈中申请一个栈帧，每个栈帧包括**局部变量区**和**操作数栈**，**用于存放此次方法调用过程中的临时变量、参数和中间结果**。

 4）本地方法栈

 用于支持native方法的执行，存储了每个native方法调用的状态。

5）方法区

存放了要加载的类信息、静态变量、final类型的常量、属性和方法信息。JVM用永久代（PermanetGeneration）

来存放方法区，（在JDK的HotSpot虚拟机中，可以认为方法区就是永久代，但是在其他类型的虚拟机中，没有永久代

的概念，有关信息可以看周志明的书）可通过**-XX:PermSize**和**-XX:MaxPermSize**来指定最小值和最大值。